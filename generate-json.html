<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ZoneAdorn JSON Generator</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fafafa; padding: 30px; }
    button { padding: 10px 20px; background: #2b7dfa; color: white; border: none; border-radius: 6px; cursor: pointer; }
    pre { background: #f1f1f1; padding: 15px; border-radius: 8px; margin-top: 20px; max-height: 400px; overflow-y: auto; }
  </style>
</head>
<body>
  <h2>üîó ZoneAdorn Auto JSON Generator</h2>
  <p>Click below to fetch all published posts from your Blogger sitemap:</p>
  <button id="generate">Generate JSON</button>
  <pre id="output">Waiting for action...</pre>

  <script>
    async function generateJSON() {
      const sitemapURL = "https://www.zoneadorn.com/sitemap.xml";
      const proxyURL = `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(sitemapURL)}`;
      const output = document.getElementById("output");
      output.textContent = "Fetching sitemap... please wait ‚è≥";

      try {
        const res = await fetch(proxyURL);
        const xmlText = await res.text();

        const parser = new DOMParser();
        const xml = parser.parseFromString(xmlText, "text/xml");

        const urls = xml.querySelectorAll("url");
        const posts = [];

        urls.forEach(u => {
          const loc = u.querySelector("loc")?.textContent;
          if (loc && !loc.includes("/search/") && !loc.includes("/feeds/")) {
            const title = loc.split("/").pop().replace(/[-_]/g, " ").replace(/\.html$/, "").trim();
            posts.push({ keyword: title, url: loc });
          }
        });

        const jsonText = JSON.stringify(posts, null, 2);
        output.textContent = jsonText;

        const blob = new Blob([jsonText], { type: "application/json" });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "published-posts.json";
        link.click();

      } catch (err) {
        output.textContent = "‚ö†Ô∏è Error: Could not fetch sitemap.\n\n" + err;
      }
    }

    document.getElementById("generate").addEventListener("click", generateJSON);
  </script>
</body>
</html>
